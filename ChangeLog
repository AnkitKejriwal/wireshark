$Id: ChangeLog,v 1.33 2003/12/13 00:55:10 gerald Exp $


2003-12-13 00:38  gerald

	* Makefile.am:

	  Add packet-isup.h as well.

2003-12-13 00:22  gerald

	* Makefile.am:

	  Add packet-ansi_map.h to the distribution.

2003-12-12 23:47  obiot

	* packet-smpp.c:

	  Always dissect a sm_submit otherwise reassembly of short messages
	  does not work.

2003-12-12 23:35  obiot

	* packet-wbxml.c:

	  Move info column update code outside of if (tree).

2003-12-12 23:23  guy

	* packet-dns.c:

	  Add some checks to make sure we're not running past the end of
	  the RR we're dissecting.  (Some RR's still don't do that check,
	  as they don't maintain an "rr_len" variable, and as
	  "get_dns_name()" doesn't do any length checking.)

	  That obviates the need for having "compute_key_id()" check the
	  length, as we won't even get to calling it if the RR is too
	  short.  Have it still do a check for sanity, but just abort if
	  the check fails, and have it return -1 if the algorithm is
	  unsupported.

	  Don't bother processing T_CERT RRs if we're not building a
	  protocol tree, don't fetch data from a T_CERT RR until we put it
	  into the tree, and fix the bug that change found, namely that we
	  were using the wrong variable in the "val_to_str()" call for the
	  certificate type.

2003-12-12 22:19  guy

	* packet-ses.c, packet-ses.h:

	  From Yuriy Sidelnikov: if the first SPDU in a TSDU has a type of
	  1 or 2, treat it specially - a type of 1 means GIVE_TOKENS, not
	  DATA_TRANSFER, in that case.

2003-12-12 21:17  guy

	* packet-pim.c:

	  From Hannes Gredler:

		  display the PIM hello option values in brackets after the
	  option
		  name;

		  in the LAN prune delay option dissector:

			  put the top-level item for the option into the
	  PIM
			  options tree rather than the PIM main tree;

			  calculate the correct LAN prune delay and display
	  it in
			  units of milliseconds;

			  calculate the correct override interval and
	  display it
			  in units of milliseconds;

			  fix the offset and length calculation.

2003-12-12 19:55  guy

	* AUTHORS, packet-ansi_a.c, packet-ansi_a.h, packet-ansi_map.c,
	  packet-ansi_map.h, packet-isup.c, packet-isup.h, gtk/Makefile.am,
	  gtk/Makefile.nmake, gtk/ansi_map_stat.c, gtk/isup_stat.c:

	  From Michael Lum:

		  Fix point code display.

		  Add taps for ANSI MAP and ISUP statistics.

2003-12-12 16:06  gerald

	* README.win32:

	  Switch from gettext 0.13 to 0.12.1.

2003-12-12 02:50  gerald

	* gtk/: dlg_utils.c, main.c:

	  In "dlg_window_new()" check to see if "top_level" has been
	  initialized, as is the case for the spawned capture process.

2003-12-11 21:23  ulfl

	* packet-afp.c, packet-bssap.c, packet-cops.c, packet-esis.c,
	  packet-gsm_sms.c, packet-isakmp.c, packet-osi-options.c,
	  gtk/dcerpc_stat.c, plugins/docsis/packet-tlv.c,
	  plugins/docsis/packet-vendor.c, wiretap/erf.c,
	  wiretap/lanalyzer.c:

	  prevent MSVC warning: "warning C4761: Größenkonflikt im Argument.
	  Konvertierung vorgenommen" -> size conflict in argument,
	  conversion done

2003-12-11 18:38  guy

	* packet-dns.c:

	  Have "compute_key_id()" return different values for different
	  errors, and have its caller put an entry into the tree for "we
	  don't support the algorithm" (the "RR too short" error is a
	  "can't happen").

2003-12-11 18:37  guy

	* epan/configure.in:

	  Add "/usr/local/include" in case the PCRE header file is there.

2003-12-11 08:54  ulfl

	* packet-dns.c:

	  replaced type u_int32_t by glib's guint32 (to satisfy MSVC)

2003-12-11 01:13  guy

	* tethereal.c:

	  Fix a typo.

2003-12-10 23:21  gerald

	* README.win32, packaging/nsis/ethereal.nsi:

	  Update the Windows environment to GLib 2.2.3 and GTK+
	  1.3.0-20030717.  This requires replacing libintl-1.dll from the
	  libintl package (which is no longer used) with intl.dll from
	  intl.dll from the gettext package.

2003-12-10 22:52  gram

	* print.c:

	  Analyzer's PDML will be changed to start the packet offset (the
	  "pos" field) at 0 instead of 1. This works better for Ethereal,
	  as our offsets start at 0. Change the "geninfo" pseudo-protocol
	  to use pos="0" instead of pos="1".

2003-12-10 22:38  obiot

	* epan/dfilter/Makefile.nmake:

	  PCRE support requires $(PCRE_CFLAGS) in CFLAGS.

2003-12-10 22:27  obiot

	* tap-wspstat.c:

	  WSP status code is hexadecimal.

2003-12-10 21:50  gerald

	* config.nmake, configure.in, epan/configure.in:

	  Bump the version to 0.10.0.  It could be (and has been) argued
	  that the last release should have been 0.10.0.

2003-12-10 21:21  guy

	* gtk/gsm_a_stat.c:

	  Oops, I checked the wrong tap into CVS somehow.

2003-12-10 21:12  gerald

	* epan/ftypes/: ftypes-int.h, ftypes.h:

	  Make the _pcre_tuple_t struct internal.

2003-12-10 19:35  guy

	* packet-dns.c:

	  From David Fort: compute and display the key ID in a DNS KEY RR,
	  if possible.

2003-12-10 19:26  guy

	* packet-isup.c:

	  From Anders Broman: add CIC to Info column.

2003-12-10 19:21  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-igap.c,
	  packet-igap.h, packet-igmp.c:

	  From Akira Endoh: IGAP support.

2003-12-10 19:21  guy

	* packet-isakmp.c:

	  Squelch a compiler warning.

2003-12-10 19:05  ulfl

	* packaging/nsis/ethereal.nsi:

	  added some more uninstall info and offering only removal of
	  program (instead of modify/repair)

2003-12-10 10:47  guy

	* packet-isakmp.c:

	  Check whether the packet length is less than the length of the
	  packet header, and give up if it is.

2003-12-09 23:45  obiot

	* gtk/tcp_graph.c:

	  Mark parameter data as unused in callback_create_help().

2003-12-09 23:15  obiot

	* epan/ftypes/Makefile.nmake:

	  Internal PCRE field type for efficient RE parsing in dfilters.

2003-12-09 23:02  obiot

	* epan/: ftypes/Makefile.am, ftypes/ftype-pcre.c,
	  ftypes/ftype-string.c, ftypes/ftypes.c, ftypes/ftypes.h,
	  dfilter/semcheck.c:

	  Internal PCRE field type for efficient RE parsing in dfilters.

2003-12-09 22:41  ulfl

	* file.c, gtk/main.h, gtk/menu.c:

	  print system enhanced, more print ranges and expanded states

2003-12-09 22:27  ulfl

	* print.c:

	  print system enhanced, more print ranges and expanded states

2003-12-09 22:21  ulfl

	* print.h, tethereal.c, gtk/print_dlg.c:

	  print system enhanced, more print ranges and expanded states

2003-12-09 22:04  ulfl

	* print.h:

	  print system enhanced, more print ranges and expanded states

2003-12-09 18:49  guy

	* Makefile.am, Makefile.nmake, packet-gsm_a.c, packet-gsm_a.h,
	  tap-ansi_astat.c, tap-gsm_astat.c, gtk/Makefile.am,
	  gtk/Makefile.nmake, gtk/ansi_a_stat.c, gtk/gsm_a_stat.c:

	  From Michael Lum:

		  new taps for GSM A-interface;

		  fixes for ANSI A-interface taps.

2003-12-09 06:48  guy

	* column.c, column.h, file.c, ui_util.h, epan/column-utils.c,
	  epan/column_info.h, gtk/main.c, gtk/packet_list.c:

	  Don't automatically size the columns - that's expensive in large
	  captures, as it has to compute the width of an auto-resizing
	  column in every row.	Just pick fixed widths for the columns (and
	  tune the width of the "Protocol" column so that it's not narrower
	  than the column title).

2003-12-09 05:56  gram

	* tethereal.c, doc/README.xml-output, doc/tethereal.pod,
	  tools/msnchat:

	  -Tpdml and -Tps force -V. Thus, -V is no longer required when
	  using -Tpdml.  Eventually, -Tps will not force -V, and will print
	  summaries when -V is not selected. However, work still has to be
	  done there.

2003-12-09 05:10  guy

	* packet-radius.c:

	  Add a new attribute type RADIUS_IP6_ADDRESS for IPv6 addresses.

	  Put in a note explaining the enum for those types.

	  From Rui Carmo: add all 3GPP VSA's.

2003-12-09 05:06  guy

	* epan/: resolv.c, to_str.c, to_str.h:

	  Add "ip6_to_str_buf()", by analogy to "ip_to_str_buf()".

2003-12-09 00:52  guy

	* packet-ansi_637.c:

	  From Michael Lum: fix incorrect switch values which resulted in
	  NULL strings being passed to ..._add_text().

2003-12-09 00:12  guy

	* packet-tcp.c:

	  As per Didier Gautheron, dissect TCP options regardless of
	  whether we're building a protocol tree, so the Info column is set
	  correctly.

2003-12-08 23:40  guy

	* packet-alcap.c, packet-ansi_637.c, packet-ansi_683.c,
	  packet-ansi_a.c, packet-ansi_map.c, packet-gsm_a.c,
	  packet-gsm_map.c, packet-gsm_sms.c, epan/to_str.c, epan/to_str.h:

	  Get rid of the private "my_decode_bitfield_value()" a number of
	  dissectors had.  Instead, rename it
	  "other_decode_bitfield_value()", put it in "epan/to_str.c", and
	  make "decode_bitfield_value()" use it.

2003-12-08 22:28  guy

	* Makefile.nmake:

	  Add a "doc" target, as per Ulf Lamping's comment.

2003-12-08 22:24  guy

	* doc/ethereal-filter.pod.template:

	  Note the types of fields for which the "contains" operator is
	  available.

	  Always capitalize the names "Ethereal" and "Tethereal" (we don't
	  capitalize the command names, however, as they're
	  all-lower-case).

	  Note that you can find out from the GUI whether Ethereal was
	  built with the PCRE library or not.

	  Fix a typo.

2003-12-08 21:57  guy

	* print.c:

	  "proto_construct_dfilter_string()" can return a null pointer,
	  e.g. for protocol tree fields that don't have values and that are
	  zero-length.

	  Combine the "if (fi->hfinfo->type != FT_PROTOCOL && fi->length >
	  0)" stuff to show the raw value into the previous "if".

2003-12-08 21:36  guy

	* AUTHORS, packet-mtp3.c, packet-mtp3.h, packet-sccp.c,
	  epan/packet_info.h, epan/to_str.c:

	  From Michael Lum: support an AT_SS7PC address type for SS7 point
	  codes, and set the direction in pinfo for SS7 packets based on
	  source and destination addresses.

2003-12-08 20:58  guy

	* packet-dcerpc.c:

	  From Jamie Fournier: don't show UNKUUID information for fragments
	  for known dissectors.

2003-12-08 20:50  guy

	* packet-srvloc.c:

	  From Greg Morris: ecode the attribute structure instead of
	  reporting a really long undecoded string.

2003-12-08 20:43  guy

	* packaging/nsis/ethereal.nsi:

	  From Lars Roland: fix a typo.

2003-12-08 20:42  guy

	* packaging/nsis/Makefile.nmake:

	  From Lars Roland: fix the NSIS Makefile to handle PCRE.

2003-12-08 20:40  guy

	* packet-isis-clv.c, packet-isis-clv.h, packet-isis-hello.c,
	  packet-isis-hello.h, packet-isis-lsp.c, packet-isis-lsp.h,
	  packet-isis-snp.c, packet-isis-snp.h:

	  From Hannes Gredler:

	  - unify the IS-IS CLV space	IS-IS uses a unified CLV space
	  across all Level and PDU Types   there is no need to define PDU-
	  and Level- Specific CLV   Types;

	  - clean up Authentication CLV   TLV #10 is the official supported
	  TLV for carrying authentication   information- todays code
	  displays TLV #10 as non-standard which   is wrong;   also the
	  notion of "Domain" "Authentication" and "Link" password   has
	  disappeared from contemporary routing SW;

	  - add IP Authentication CLV dissector   this CLV is depreciated -
	  however it is using different semantics   than TLV #10 so we need
	  a dedicated dissector;

	  - add Checksum CLV dissector	 add support for RFC 3358 Checksum
	  CLVs	 majority of code re-used from the LSP checksum
	  verification	 dissector.

2003-12-08 20:37  obiot

	* packet-wsp.c, packet-mmse.c, packet-wbxml.c:

	  Get rid of the integer media type dissector table in WSP, WBXML
	  and MMSE.

2003-12-08 20:36  guy

	* packet-dsi.c:

	  From Didier Gautheron: check packet format in get_dsi_pdu_len.

2003-12-08 20:36  guy

	* packet-afp.c:

	  From Didier Gautheron: add offset and size parameters in info
	  colum for read and write commands.

2003-12-08 20:25  guy

	* packet-sip.c:

	  From Anders Broman:

		  Call subdissectors regardless of whether we're building a
		  protocol tree or not.

		  Use the "media_type" dissector table to hand off to
		  subdissectors, rather than wiring in SDP.

		  Put the message body into a subtree of the SIP tree
	  rather than
		  at the top level.

2003-12-08 19:25  ulfl

	* gtk/menu.c:

	  moved "File->Save Highlighted Data" to "File->Export->Raw Packet
	  Data"

2003-12-08 17:54  ulfl

	* doc/ethereal.pod:

	  updated to reflect the menu redesign changes

2003-12-08 17:49  ulfl

	* gtk/menu.c:

	  removed seperator between the two print menuitems

2003-12-07 19:09  obiot

	* AUTHORS:

	  Update address of Johan Feyaerts. Dfilter matches operator.

2003-12-07 18:32  obiot

	* doc/ethereal-filter.pod.template:

	  Clarify dfilter syntax (mainly the implicit exists operator), add
	  subsections in syntax section, add description of new "contains"
	  operator (and inform that it is only available if libpcre has
	  been linked in).

2003-12-07 18:09  obiot

	* packet-mmse.c, packet-wbxml.c, packet-wsp.c:

	  Remove the literal WSP content type dissector table, and replace
	  it with the "media_type" table defined in the HTTP dissector.

2003-12-07 09:43  oabad

	* gtk/main.c:

	  Update various set_menu_object_data() calls to reflect recent
	  menu hierarchy changes. This avoids a crash when selecting "Folow
	  TCP stream" from the "Analyze" menu.

2003-12-07 03:46  guy

	* packet-sdp.c:

	  Register the SDP dissector with the media_type dissector table
	  with its media type.

2003-12-07 03:34  guy

	* packet-http.c:

	  Use a cleanup handler to free the Content-Type header value, so
	  it gets freed even if we throw an exception after processing the
	  Content-Type header but before we call a subdissector.

2003-12-07 03:21  guy

	* packet-http.c:

	  Change the name of the variable holding the dissector table
	  pointer to match the previous checkin.

2003-12-07 03:17  guy

	* packet-http.c, packet-mmse.c:

	  Rename the "http.content_type" dissector table to "media_type",
	  as it's for use in any dissector that uses Internet media types.

2003-12-07 02:42  guy

	* packet-nt-sonmp.c:

	  Only check the destination address if it's AT_ETHER; otherwise,
	  there's no guarantee that "data[5]" exists or can be interpreted
	  in that fashion.

2003-12-07 02:26  guy

	* packet-ssl.c:

	  From Devin Heitmueller: include the AES ciphersuites from RFC
	  3268.

2003-12-07 02:23  guy

	* doc/tethereal.pod:

	  Put the "-V" flag in boldface, so pod2man doesn't whine.

2003-12-07 00:04  gerald

	* Makefile.nmake, README.win32, config.h.win32, config.nmake,
	  epan/Makefile.nmake, epan/config.h.win32,
	  epan/ftypes/Makefile.nmake, packaging/nsis/ethereal.nsi:

	  Add PCRE support to the Windows build.

2003-12-06 19:26  oabad

	* packet-nt-sonmp.c:

	  Check if pinfo->dl_dst.data is not NULL before accessing the data
	  (it was NULL in one of my "linux cooked" captures which contains
	  no destination address).

2003-12-06 19:14  jmayer

	* packet-mtp3mg.c:

	  Declaration included the line above

2003-12-06 16:35  gram

	* Makefile.am, acinclude.m4, configure.in, util.c,
	  epan/acinclude.m4, epan/configure.in, epan/dfilter/dfvm.c,
	  epan/dfilter/dfvm.h, epan/dfilter/gencode.c,
	  epan/dfilter/grammar.lemon, epan/dfilter/scanner.l,
	  epan/dfilter/semcheck.c, epan/dfilter/sttype-test.c,
	  epan/dfilter/sttype-test.h, epan/ftypes/ftype-bytes.c,
	  epan/ftypes/ftype-double.c, epan/ftypes/ftype-integer.c,
	  epan/ftypes/ftype-ipv4.c, epan/ftypes/ftype-none.c,
	  epan/ftypes/ftype-string.c, epan/ftypes/ftype-time.c,
	  epan/ftypes/ftype-tvbuff.c, epan/ftypes/ftypes.c,
	  epan/ftypes/ftypes.h:

	  From Olivier Biot

	  New "matches" operater in display filter language. Uses PCRE.

	  If a "matches" operator is found in a dfilter while libpcre has
	  not been used to build the binary, then an exception is thrown
	  after using dfilter_fail() to set an apporporiate error message.

2003-12-06 06:22  gram

	* epan/Makefile.am:

	  slab.h needs to be in libethereal_a_SOURCES

2003-12-06 06:09  gram

	* Makefile.am, packet-frame.c, packet-frame.h, print.c, print.h,
	  tethereal.c, doc/README.xml-output, doc/tethereal.pod,
	  epan/proto.c, epan/proto.h, tools/EtherealXML.py,
	  tools/Makefile.am, tools/msnchat:

	  Add the ability to print packet dissections in PDML (an XML-based
	  format) to tethereal. It could be added to Ethereal, but the GUI
	  changes to allow the user to select PDML as a print format have
	  not been added.

	  Provide a python module (EtherealXML.py) to help parse PDML.

	  Provide a sample app (msnchat) which uses tethereal and
	  EtherealXML.py to reconstruct MSN Chat sessions from packet
	  capture files. It produces a nice HTML report of the chat
	  sessions.

	  Document tethereal's PDML and EtherealXML.py usage in
	  doc/README.xml-output

	  Update tethereal's manpage to reflect the new [-T pdml|ps|text]
	  option

2003-12-06 04:05  guy

	* file.c, ui_util.h, gtk/packet_list.c:

	  From Jeff Morriss: avoid at least some N^2 behavior when changing
	  the time stamp format.

2003-12-05 22:33  guy

	* packet-ccsds.c:

	  "hf_ccsds_secheader" is an FT_BOOLEAN; use
	  "proto_tree_add_boolean()" for it.

2003-12-05 16:00  gerald

	* Makefile.nmake, README.win32, config.nmake:

	  Switch over to Net-SNMP 5.1.	A ZIP file of the Net-SNMP 5.1
	  sources plus a static Windows library (netsnmp.lib) has been
	  placed at

	      http://www.ethereal.com/distribution/win32/development/

	  The Net-SNMP documentation recommends against using a DLL at the
	  present time.

2003-12-05 09:34  guy

	* packet-sdp.c:

	  We have to parse the SDP packet even if we're not building a
	  protocol tree, as we might be setting up a conversation.

2003-12-05 09:33  guy

	* packet-isup.c:

	  Subdissectors must be called regardless of whether a protocol
	  tree is being built.

2003-12-05 09:25  guy

	* plugins/mgcp/packet-mgcp.c:

	  Subdissectors must be called regardless of whether a protocol
	  tree is being built.

2003-12-04 22:37  guy

	* plugins/asn1/Makefile.am:

	  From some reason, at least on Mac OS X 10.3, the change to have
	  the protocol tree stuff not use GNodes means that the ASN.1
	  plugin now needs to be explicitly linked against GLib in order to
	  get access to the GNode routines, otherwise you get errors from
	  the run-time linker.

2003-12-04 19:53  guy

	* epan/: proto.c, proto.h:

	  It turns out the protocol tree parent link was used, so we need
	  it in our new scheme.

2003-12-04 10:59  guy

	* file.c, print.c, proto_hier_stats.c, tap-protohierstat.c,
	  epan/proto.c, epan/proto.h, gtk/proto_draw.c, gtk/rtp_analysis.c:

	  Don't use GNodes for the protocol tree, put the sibling pointer,
	  and pointers to the first *and* last child, in the "proto_node"
	  structure itself.  That saves us one level of indirection and
	  memory allocation, and lets us append to a tree by appending to
	  the last child directly, rather than having to scan through the
	  list of siblings of the first child to find the end of that list.

2003-12-04 08:15  sahlberg

	* packet-kerberos.c:

	  update to kerberos

	  if the kerberos blob contains a krb error, print the error string
	  to COL_INFO

2003-12-04 08:13  sahlberg

	* packet-ldap.c:

	  update to ldap.

	  some implementations specify GSSAPI in the bind call.  the
	  encapsulation seems to be the same as GSS-SPNEGO so handle it the
	  same way

2003-12-04 06:02  gram

	* packet-wsp.c:

	  Add {0, NULL} to the vals_wsp_reason_codes value_string array.

2003-12-04 05:59  gram

	* packet-wlancap.c:

	  Add {0, NULL} to all the value_string arrays.

2003-12-04 05:57  gram

	* packet-socks.c:

	  Add {0, NULL} to the reply_table_v5 value_string array.

2003-12-04 05:55  gram

	* packet-ldp.c:

	  ldp.msg.tlv.returned.msg.ubit needs to be an FT_BOOLEAN field,
	  not an FT_UINT8, since it is using a true_false_string struct to
	  print its values.  Add {0, NULL} to the fec_vc_interfaceparm
	  value_string array.

2003-12-04 05:47  gram

	* packet-isup.c:

	  Add {0, NULL} to the isup_Pass_on_not_possible_indicator_vals and
	  ISUP_Broadband_narrowband_interworking_indicator_vals
	  value_string arrays.

2003-12-04 05:40  gram

	* packet-fcswils.c:

	  Add {0, NULL} to end of fc_swils_rscn_addrfmt_val value_string
	  array.

2003-12-04 05:38  gram

	* packet-fcip.c:

	  Add {0, NULL} to end of fcencap_proto_vals value_string array.

2003-12-04 00:45  guy

	* filters.c, filters.h, gtk/dcerpc_stat.c,
	  gtk/endpoint_talkers_table.c, gtk/fc_stat.c, gtk/filter_prefs.c,
	  gtk/find_dlg.c, gtk/h225_counter.c, gtk/h225_ras_srt.c,
	  gtk/ldap_stat.c, gtk/mgcp_stat.c, gtk/prefs_dlg.c,
	  gtk/rpc_stat.c, gtk/service_response_time_table.c,
	  gtk/smb_stat.c:

	  In GTK+ 2.x, "gtk_entry_get_text()" returns a "const gchar *";
	  assign its value to pointer-to-const variables.

2003-12-03 23:54  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-gsm_map.c,
	  doc/ethereal.pod:

	  From Felix Fei: GSM MAP support.

	  From Michael Lum:

		  Modified for better TCAP separation, fixed EOC handling
	  (a la
		  TCAP).

		  Added parameter parsing (although not dissection or
	  naming).

2003-12-03 23:46  guy

	* AUTHORS, packet-ansi_a.c, packet-ansi_a.h, tap-ansi_astat.c,
	  gtk/Makefile.am, gtk/Makefile.nmake, gtk/ansi_a_stat.c:

	  From Michael Lum: Ethereal tap for ANSI A-interface.

	  Tweak some Makefile.nmake whitespace.

2003-12-03 22:50  guy

	* packet-mtp2.c, packet-mtp3.c:

	  From Jeff Morriss: add support for WTAP_ENCAP_MTP2 and
	  WTAP_ENCAP_MTP3.

2003-12-03 22:40  guy

	* wiretap/: AUTHORS, libpcap.c, wtap.c, wtap.h:

	  From Jeff Morriss: add support for libpcap MTP2 and MTP3
	  captures.

	  Add a missing entry in "encap_table[]" for Bluetooth H4, and fix
	  some comments.

2003-12-03 20:01  guy

	* packet-bootp.c:

	  From Greg Morris: handle the backwards compatibility flag for
	  options 78 and 79.

2003-12-03 19:59  guy

	* gtk/menu.c:

	  From Greg Morris: the "File->Save Highlighted" menu item has no
	  icon, so don't use "ITEM_FACTORY_STOCK_ENTRY()" for it.

2003-12-03 19:47  guy

	* wiretap/airopeek9.c:

	  "strtoul()" returns a "long", not a "long long".

2003-12-03 10:14  sahlberg

	* epan/tvbuff.c:

	  Replace two expensive macros with a much simpler mechanism to
	  prevent memory leaks due to exceptions.

	  makes my tethereal testcase ~1% faster.

2003-12-03 09:50  sahlberg

	* epan/: proto.c, tvbuff.c, tvbuff.h:

	  performance update

	  replace tvb_raw_offset() which is essentially a simple assignment
	  and which is called a lot with a macro.

	  this makes my tethereal testcase 2-3% faster.

2003-12-03 09:28  guy

	* packet-ncp2222.inc, print.c, proto_hier_stats.c,
	  tap-protohierstat.c, epan/proto.c, epan/proto.h,
	  epan/ftypes/ftypes.c, epan/ftypes/ftypes.h, gtk/main.c,
	  gtk/menu.c, gtk/prefs_dlg.c, gtk/rtp_analysis.c:

	  The "ptr_u" unions no longer have a "next" pointer - they now
	  just have one member - or have one that's not used, so get rid of
	  those unions.

2003-12-03 08:53  guy

	* epan/: proto.c, proto.h, slab.h, ftypes/ftypes.c,
	  ftypes/ftypes.h:

	  Instead of requiring slab-allocated structures to have a "next"
	  pointer, when adding them to the free list, cast the pointer to
	  the structure to a pointer to a "freed_item_t" which contains the
	  "next" pointer.

	  This reduces the memory requirement for some of those structures,
	  and leaves us free to slab-allocate structures that have a "next"
	  pointer for other reasons.

2003-12-03 08:43  sahlberg

	* packet-smb.c:

	  Update to SMB ReadAndX replies.

	  There might be a 4 (not 2) byte datalen high field.  If there is
	  no such field (due to an early dialect being used) these bytes
	  are often 0xff.  If these four bytes are all 0xff    dont display
	  them in the tree.

2003-12-03 07:46  guy

	* README.linux:

	  Bring it up to date.

2003-12-02 23:14  guy

	* file.c, tethereal.c, epan/column-utils.c, epan/column_info.h,
	  gtk/main.c:

	  From Didier Gautheron: for each column format type, save the
	  first and last columns, if any, with that format, and use that to
	  speed up processing of columns with a particular format and
	  checking whether we're displaying a column with a particular
	  format.

2003-12-02 21:15  guy

	* packet-ncp2222.inc, packet-smb-sidsnooping.c, tap-iostat.c,
	  epan/proto.c, epan/proto.h, epan/dfilter/dfvm.c,
	  epan/ftypes/ftypes.c, epan/ftypes/ftypes.h, gtk/io_stat.c,
	  gtk/main.c, gtk/rtp_analysis.c:

	  From Didier Gautheron: put an "fvalue_t" structure into a
	  "field_info" structure, rather than separately allocating
	  "fvalue_t"s and having the "field_info" structure point to them -
	  this appears to speed up protocol tree construction a bit.

2003-12-02 20:27  guy

	* wiretap/airopeek9.c:

	  Check for errors and EOF, and handle them appropriately; don't
	  treat all errors when reading the header as indications that the
	  file isn't an AiroPeek V9 file.

	  Put in comments nothing some additional checks we should do.

2003-12-02 19:37  guy

	* AUTHORS, doc/ethereal.pod, wiretap/AUTHORS, wiretap/Makefile.am,
	  wiretap/Makefile.nmake, wiretap/airopeek9.c, wiretap/airopeek9.h,
	  wiretap/file_access.c, wiretap/wtap.h:

	  From Martijn Schipper: support for reading AiroPeek files in V9
	  capture file format (AiroPeek 2.x).

2003-12-02 18:50  guy

	* packet-tpkt.c:

	  Tomas Kukosa noted that the TPKT dissector spends a significant
	  amount of time in "find_protocol_by_id()"; the protocol_t pointer
	  for a protocol doesn't change over time, so get that pointer when
	  the protocol is registered and save it.

2003-12-02 18:35  guy

	* packet-isakmp.c:

	  From Yaniv Kaul:

		  1) fix description of Check Point version 5004;

		  2) add description of Check Point version 5005.

2003-12-02 10:23  sahlberg

	* epan/: proto.c, tvbuff.c, tvbuff.h:

	  Move the definition of the tvbuff_t structure and friends to
	  tvbuff.h so that we can change tvb_get_ds_tvb() into a macro.

	  This function was a single line assignment and was called a lot.

	  This made tethereal ~2.5% faster in one testcase I use.

2003-12-02 09:47  sahlberg

	* epan/: proto.c, ftypes/ftypes.c, ftypes/ftypes.h:

	  Use the LSAB_ALLOC and SLAB_FREE macros to allocate/free fvalue_t
	  data

2003-12-02 09:11  sahlberg

	* epan/: proto.c, slab.h:

	  Moving SLAB_ALLOC and SLAB_FREE to its own header file

2003-12-02 09:05  guy

	* AUTHORS, packet-isakmp.c, doc/ethereal.pod:

	  From Arnaud Jacques: fix a typo, and handle another CheckPoint
	  version number.

2003-12-02 06:06  guy

	* packet-fcfzs.c:

	  From Dave Sclarsky:

		  Correct several problems with zoneset decodes (e.g.  the
	  zoneset
		  and zone name lengths do *not* include the pad bytes, so
	  the
		  offset calculation needed to be fixed).

		  Move the decode of zoneset name into the routine
		  "dissect_fcfzs_zoneset", so that it is done in only one
	  place.

2003-12-02 05:53  guy

	* packet-ses.c:

	  Don't call the presentation layer dissector if we don't have a
	  handle for it.

2003-12-02 02:58  guy

	* packet-bssap.c, packet-tcap.c:

	  From Michael Lum: don't register the handoff routine for
	  dissectors as a preference change callback if the ports they
	  register on aren't preferences.

2003-12-01 23:41  guy

	* epan/value_string.c, epan/value_string.h,
	  plugins/plugin_api_list.c, plugins/Xass-list,
	  plugins/Xplugin_api.c, plugins/Xplugin_api.h,
	  plugins/Xplugin_api_decls.h, plugins/Xplugin_table.h:

	  From Tomas Kukosa: add "decode_enumerated_bitfield_shifted()",
	  which is like "decode_enumerated_bitfield()" but handles
	  value_string tables containing values as they appear in the
	  bitfield rather than as they appear in the item containing the
	  bitfield.

2003-12-01 23:26  guy

	* packet-m2ua.c:

	  From Michael Lum: add a preference setting to specify the
	  parameter tag for "Protocol Data 1", as it changed between draft
	  7 and RFC 3331.

2003-12-01 23:05  guy

	* Makefile.am, Makefile.nmake, packet-ansi_a.c, packet-ansi_a.h,
	  packet-bssap.c, tap-ansi_astat.c:

	  From Michael Lum:

		  add a message statistics tap for ANSI A interface for
	  Tethereal;

		  fix the BSSAP, BSMAP, and DTAP interface dissectors to
	  call
		  subdissectors even if no protocol tree is being built.

2003-12-01 22:25  guy

	* packet-ranap.c:

	  From Michael Lum: add a heuristic RANAP dissector, for use atop
	  SCCP, as the SCCP dissector currently doesn't support
	  conversations to be given dissectors.

2003-12-01 20:27  gerald

	* util.c:

	  Don't automatically fill in a capture filter if CLIENTNAME is set
	  to "Console".

2003-12-01 17:25  gerald

	* README.win32:

	  Updates for new zlib.

2003-12-01 17:19  gerald

	* packaging/nsis/ethereal.nsi:

	  Switch from zlib.dll to zlib1.dll.

2003-12-01 17:17  gerald

	* config.nmake:

	  Switch to the new (and official) zlib DLL from www.gzip.org.

2003-12-01 06:59  sharpe

	* wiretap/file_access.c:

	  It's RedHat, not Red Hat.

2003-12-01 02:01  guy

	* gtk/: file_dlg.c, file_dlg.h, print_dlg.c, proto_draw.c:

	  "select_file_cb()" only needs a title, not a "construct_args_t" -
	  "construct_args_t" is for use with filter dialogs, and the
	  members other than the title apply only to filter dialogs.

	  Have "select_file_cb()" actually use the title supplied to it.

2003-12-01 01:57  sharpe

	* gtk/menu.c:

	  Fix the accelerator issue ...

2003-11-30 23:05  guy

	* gtk/proto_draw.c:

	  Not all platforms have <unistd.h> - in particular, Windows
	  doesn't.

	  If you're using "open()", "close()", "read()", "write()", etc.,
	  you should include <io.h> on Windows.

2003-11-30 18:01  sharpe

	* gtk/proto_draw.c:

	  Fix some warnings in proto_draw.c

2003-11-30 04:40  sharpe

	* gtk/menu.c:

	  Rename that to Save Highlighted with Ctl-H as the accellerator.

2003-11-30 04:37  sharpe

	* gtk/menu.c:

	  Add Save Selected as a menu item in the File Menu.

	  This still has a way to go, though, because the menu item should
	  be greyed out until something is Highlighted.

2003-11-30 04:21  sharpe

	* gtk/: color_dlg.c, file_dlg.c, file_dlg.h, menu.c, print_dlg.c,
	  proto_draw.c, toolbar.c:

	  Move print_file_cb out of gtk/print_dlg.c and into gtk/file_dlg.c
	  and rename it to select_file_cb to reflect its function.

	  While this cleans things up a bit, I am still not happy because
	  now filter_prefs.h must be included before file_dlg.h just to get
	  construct_args_t.

2003-11-29 12:34  jmayer

	* doc/README.tapping:

	  Fix two small typos

2003-11-29 06:15  sharpe

	* gtk/menu.c:

	  Properly capitalize the string for the menu item.

2003-11-29 06:09  sharpe

	* gtk/: file_dlg.h, menu.c, print_dlg.c, proto_draw.c:

	  Add an entry in the byte_view pane that allows the user to save
	  the highlighted data to a file. This allows the user to select
	  some stuff, and analyse it with external tools, and is very
	  useful for quickly prototying dissectors etc.

	  This works by retrieving the info that is needed to define where
	  the selected region is.

	  It puts up a dialog box that asks for the file to save in.

	  However, it is an ugly hack, because it reuses print_file_cb,
	  while print_file_cb should be moved into file_dlg.c.

	  It also needs to have some warning dialogs put up in error cases.

	  Finally, it would be good to be able to select a region in the
	  byte_view, which you can do with click and drag, and then have a
	  menu item to save the selected bytes.

2003-11-29 03:55  guy

	* AUTHORS, packet-gtp.c, doc/ethereal.pod:

	  From melerski [AT] poczta.onet.pl: fix a problem with unknown
	  IEs.

2003-11-28 19:13  ulfl

	* gtk/menu.c:

	  renamed frame to packet in all GUI elements moved "Enabled
	  Protocols" and such from "View" to "Analyze" toplevel menu

2003-11-28 19:02  ulfl

	* gtk/goto_dlg.c:

	  renamed frame to packet in all GUI elements

2003-11-28 19:00  ulfl

	* gtk/capture_info_dlg.c:

	  use dlg_window_new instead of gtk_window_new

2003-11-28 18:59  ulfl

	* gtk/: toolbar.c, find_dlg.c:

	  renamed frame to packet in all GUI elements

2003-11-28 00:44  ulfl

	* gtk/capture_info_dlg.c:

	  label changed from "Portions" to "% of total" as suggested by Guy

2003-11-28 00:13  ulfl

	* gtk/main.c:

	  using dlg_utils.c functions to catch the ESC key to close the
	  dialog

2003-11-28 00:07  ulfl

	* gtk/: supported_protos_dlg.c, plugins_dlg.c:

	  using dlg_utils.c functions to catch the ESC key to close the
	  dialog

2003-11-27 23:25  ulfl

	* gtk/help_dlg.c:

	  using dlg_utils.c functions to catch the ESC key to close the
	  dialog

2003-11-27 22:29  guy

	* print.c:

	  "representation", in an "item_label_t", is now an array, not a
	  pointer, so "fi->rep->representation" can't be null.

2003-11-27 22:15  guy

	* tap-rpcstat.c, tap-wspstat.c:

	  Fix comments to correctly refer to the "-z" option.

2003-11-27 22:14  guy

	* tap-rpcstat.c:

	  From Michael Lum: fix the usage message to refer to "-z", not
	  "-Z".

2003-11-27 22:12  guy

	* gtk/main.c:

	  Show the -z flag in the usage message.

2003-11-27 22:04  guy

	* tethereal.c:

	  From Michael Lum: fix the usage message to say "-z", not "-Z".

2003-11-27 21:20  guy

	* AUTHORS, packet-rtp-events.c, doc/ethereal.pod:

	  From Arsen Chaloyan: fix offsets in "proto_tree_add" calls.

2003-11-27 21:09  guy

	* etypes.h, packet-ethertype.c, plugins/rtnet/packet-rtnet.c:

	  From Erwin Rol: RTCFG support.

	  Add in a URL to the RTNET home page.

2003-11-27 21:02  guy

	* packet-dns.c:

	  From David Fort: fix to previous patch.

2003-11-27 20:34  ulfl

	* gtk/menu.c:

	  Redesign of the whole menu structure, to be more intuitive to the
	  user and conforms somewhat better to the Gnome Human Interface
	  Guideline

2003-11-27 17:18  ulfl

	* print.c:

	  bugfix: removed access violation when using "File/Print Packet".
	  The label_ptr could be NULL, when calling function print_line

2003-11-27 00:22  ulfl

	* gtk/help_dlg.c:

	  using text files from help dir, to display the help texts.  the
	  "dynamic protocol fields" are already moved to
	  gtk/supported_protos_dlg.c

2003-11-27 00:17  ulfl

	* help/: capture_filters.h, display_filters.h, faq.h, overview.h,
	  well_known.h:

	  Added this intermediate files, until a Makfile.am is available
	  for unix systems

2003-11-26 23:23  guy

	* AUTHORS, packet-dns.c, doc/ethereal.pod:

	  From David Fort: DNS DSS RR support.

2003-11-26 12:22  sahlberg

	* epan/: proto.c, proto.h:

	  Speed updates

	  create generic macros for allocating/freeing structures.

	  remove one more slow GMemChunk and replace it with a simple
	  linked list

	  ~4% speed improvement in my tests.

	  the allocated data is never freed.   this may be a problem if
	  ethereal is ever supported on a platform lacking resource
	  tracking but makes the implementation faster and simpler.

2003-11-26 02:58  guy

	* AUTHORS, packet-giop.c, doc/ethereal.pod:

	  From Patrick Kursawe: rename "getline()" so it doesn't collide
	  with the "getline()" declared in <stdio.h> with recent versions
	  of glibc.

	  Fix a typo in the AUTHORS file.

2003-11-26 02:54  guy

	* pcap-util.c:

	  From Jaime Fournier: fix a typo.

2003-11-25 20:26  guy

	* AUTHORS, packet-ucp.c, doc/ethereal.pod:

	  From Reinhard Speyerer: handle 10-digit UCP dates, which lack a
	  seconds value.

2003-11-25 20:02  guy

	* epan/proto.c:

	  As with fvalue_t, so with field_info and item_label - the
	  individual items aren't individually g_mallocated and can't be
	  g_freed, only the chunks can.

2003-11-25 19:25  guy

	* epan/ftypes/ftypes.c:

	  Individual fvalue_t's aren't individually allocated with
	  "g_malloc()", so they can't be freed with "g_free()"; keep a list
	  of the chunks of "fvalue_t"s, which are whare are allocated with
	  "g_malloc()", so we can free them all.

2003-11-25 18:02  guy

	* packet-sip.c:

	  From Anders Broman: add more SIP headers, and the PUBLISH method.

2003-11-25 14:16  sahlberg

	* epan/proto.c:

	  replace free_node_field_info with a macro since it is only called
	  from one other place in the code and this reduces one unnecessary
	  function call overhead.  and it makes ethereal ~1% faster.

2003-11-25 14:11  sahlberg

	* epan/proto.c:

	  rename FREE_FIELD_INFO to FIELD_INFO_FREE for consistency

2003-11-25 14:10  sahlberg

	* epan/proto.c:

	  create a FIELD_INFO_NEW for consistency

2003-11-25 14:07  sahlberg

	* file.c, print.c, epan/proto.c, epan/proto.h, gtk/proto_draw.c:

	  remove another slow GMemChunk from ethereal making ethereal a
	  little bit faster

2003-11-25 13:23  sahlberg

	* epan/proto.c:

	  change free_field_info to FREE_FIELD_INFO to indicate it is a
	  macro and not a function

2003-11-25 13:20  sahlberg

	* epan/proto.c, epan/dfilter/dfvm.c, epan/ftypes/ftype-ipv4.c,
	  epan/ftypes/ftype-string.c, epan/ftypes/ftypes-int.h,
	  epan/ftypes/ftypes.c, epan/ftypes/ftypes.h,
	  gtk/dfilter_expr_dlg.c:

	  fvalue_free() is one of the most called functions.  This function
	  is also very small, so small that teh overhead for the actual
	  function call and return is likely to be a significant part of
	  its execution time.

	  change it into a macro and make it thus slightly faster by
	  eliminating the function call overhead.

2003-11-25 08:50  sahlberg

	* epan/ftypes/: ftypes.c, ftypes.h:

	  Change the handling of temporary allocation of fvalue_t
	  structures to be faster.  Use a similar technique as was used in
	  epan/proto.c to speed up the field_info allocation/deallocation
	  routines

2003-11-25 08:19  guy

	* packet-dcerpc.c:

	  From Jaime Fournier: show the RPC version of the unknown
	  interface in the Info column.

2003-11-25 08:10  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-dcerpc-budb.c,
	  packet-dcerpc-epm4.c, packet-dcerpc-icl_rpc.c,
	  packet-dcerpc-rs_prop_acct.c:

	  From Jamie Fournier: DCE RPC EPM version 4 support, and stub
	  support for BUDB, ICL RPC, and RS_PROP_ACCT DCE RPC-based
	  protocols.

2003-11-25 05:58  guy

	* wiretap/cosine.c:

	  "file_seek()" sets "*err" - we don't have to set it ourselves.

	  The same is true of "parse_cosine_rec_hdr()".

2003-11-25 05:56  guy

	* wiretap/network_instruments.c:

	  "file_seek()" sets "*err" - there's no need to set it ourselves.
	  It returns -1 on errors, so just check for that.

2003-11-25 00:21  guy

	* ipproto.h:

	  Fix a typo.

2003-11-24 23:46  guy

	* packet-ccsds.c:

	  Eliminate compiler warnings.

2003-11-24 22:11  guy

	* packet-ncp2222.inc, print.c, proto_hier_stats.c,
	  tap-protohierstat.c, epan/proto.c, epan/proto.h, gtk/main.c,
	  gtk/menu.c, gtk/prefs_dlg.c, gtk/rtp_analysis.c:

	  Make the recent epan/proto.{c,h} change compile.

2003-11-24 21:42  guy

	* ipproto.c, ipproto.h, packet-mip6.c:

	  Preserve 62 as an (old) IP protocol type for mobility headers.

2003-11-24 21:12  sahlberg

	* epan/: proto.c, proto.h:

	  performance enhancement to proto.c

	  Removed the GMemChunk used to allocate/free field_info structures
	  and used a free list to store the freed structs until they are
	  allocated again.

	  Ethereal will allocate more field_info structs as it needs to but
	  never free them. Instead the are just placed in a cheap and fast
	  free list so that if we want to use the struct again, this will
	  be fast.

	  This affects the speed of the two functions alloc_field_info()
	  that should be slightly faster now free_field_info() that was
	  replaced with a 2 line macro.

	  All in all  my testing suggests that ethereal is 2-3% faster with
	  this patch.

2003-11-24 17:41  ulfl

	* Makefile.nmake:

	  bugfix: corrected clean and distclean targets

2003-11-24 00:34  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-ccsds.c,
	  doc/ethereal.pod:

	  From Scott Hovis :CCSDS (Consultative Committee for Space Data
	  Systems) support.

2003-11-24 00:05  guy

	* packet-isup.c:

	  From Anders Broman: fix dissection of GRS/GRA messages.

2003-11-23 23:42  guy

	* Makefile.nmake:

	  Include the BFD dissector when building with MSVC++.

2003-11-23 22:00  gerald

	* AUTHORS, Makefile.am, packet-bfd.c:

	  From Hannes Gredler: Add support for Bi-directional Fault
	  Detection (BFD).

2003-11-22 12:02  jmayer

	* packet-radius.c:

	  - Bugfix: Passworddecoding should only be done for attribute 2,
	  but		not for VSA 2 - Fixme comment about length handling
	  added - Cleanup: Setting a variable to the right type removes the
	  necessity	      for casts.

2003-11-22 11:12  sahlberg

	* packet-h245.c:

	  Change the way signalType is dissected to be compatible with and
	  dissect the packets from Martin R and Paul H.

	  I still think ethereal was correct before this patch and that
	  this patch is not compatible with teh standard.  Anyway, that
	  doesnt matter much. With this patch ethereal will dissect the
	  packets properly.  Time to study x691 again.

2003-11-22 08:35  guy

	* ipproto.h, packet-ipv6.h:

	  From Martti Kuparinen: use correct values for Mobile IPv6.

2003-11-22 04:41  sahlberg

	* epan/proto.c:

	  As per Guys suggestion, continue optimizing proto.c to macroize
	  it and make it even faster

2003-11-21 22:18  guy

	* packet-smpp.c:

	  From Olivier Biot: fix up the description of the
	  "port_number_udh_means_wsp" preference.

2003-11-21 22:00  guy

	* packet-wsp.c:

	  From Olivier Biot:

		  * Fix the WSP dissector so a Quoted-string with
	  extraneous
		    trailing quote is displayed without duplicated final
	  quote, and
		    issue a warning in the protocol tree.
		  * Remove the Openwave x-up-proxy-client-id header
	  decoding as it
		    was incorrectly decoded as a text string, and process
	  it with
		    the default Openwave header parser.
		  * Fix byte highlighting of some WSP parameters.
		  * Rename the WSP parameter filter names so they don't all
	  refer to
		    content_type.

2003-11-21 21:58  guy

	* packet-wbxml.c, epan/packet.c, epan/packet_info.h:

	  From Olivier Biot:

		  * Add a "match_string" field to the "packet_info"
	  structure,
		    saving the string value that matched in a string
	  dissector
		    lookup, by analogy to "match_port" - this was required
	  for
		    dissection with token rendering of WBXML content when
	  no public
		    ID was given (e.g. Nokia/Ericsson OTA provisioning
	  data).
		  * Add support for textual content type based WBXML token
		    mapping.
		  * Add extra WBXML public identifiers.
		  * Add the Nokia/Ericsson OTA provisioning (version 7)
	  token
		    definitions.
		  * Inform the user when a content-type based token match
	  is found.

2003-11-21 21:33  guy

	* AUTHORS, packet-dcerpc-srvsvc.c, doc/ethereal.pod:

	  From Eric Wedel: fix dissection of NetServerDiskEnum reply.

2003-11-21 19:24  guy

	* gtk/rtp_stream.c:

	  From Lars Ruoff: use the pointer to the RTP payload, rather than
	  extracting the data from the frame directly.

2003-11-21 14:58  sahlberg

	* epan/: proto.c, proto.h:

	  Performance fix

	  In the GPROF logs proto_registrar_get_nth() used to take anything
	  between 2.5 and 5.5% of the time.

	  Replace the GLIB array with a handroleld one for one of the
	  private structures.

	  the function should now be virtually zero cost and thus ethereal
	  should be 2.5-5.5% faster on those traces.

	  anyone that wants to, please rerun GPROF with this fix and see
	  what has changed.

2003-11-21 08:40  guy

	* packet-dcerpc-epm.c:

	  A "handle_t" as the first argument to a call doesn't seem to be
	  sent over the wire, at least in the DCE RPC 1.1 code.

	  That suggests that the first 24 bytes of a Map request are the
	  UUID pointer that the EPM IDL says should be there, not a context
	  handle.

2003-11-21 08:33  guy

	* pcap-util.c:

	  Maybe the problem is that the compilers used on AIX weren't
	  defining "AIX", and that code was never compiled.  Libpcap uses
	  "_AIX" to conditionally compile in the extra AIX BPF support;
	  we'll do the same.

2003-11-21 08:30  guy

	* pcap-util.c:

	  Pass "strncmp()" the right number of arguments.  (Why hasn't
	  anybody reported this as a problem when compiling on AIX?
	  Doesn't any compiler complain that "strncmp()" isn't being passed
	  enough arguments?  GCC sure did in a test program I built on
	  FreeBSD 3.4....)

2003-11-21 04:01  guy

	* packet-dcerpc.c:

	  From Jamie Fournier: add the UUID to the Info column for datagram
	  calls.

2003-11-21 02:57  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-dcerpc-rs_plcy.c:

	  From Jamie Fournier: DCERPC RS_PLCY support.

2003-11-21 02:48  guy

	* packet-dcerpc-ndr.c, packet-dcerpc.h:

	  The 32-bit integer at the beginning of a context_handle is called
	  "context_handle_attributes" in the DCE RPC 1.1 "nbase.idl".
	  Rename our structure member accordingly.

	  Note in a comment that we should perhaps display a context_handle
	  as the attributes and UUID.

	  Use "proto_tree_add_item()", not "proto_tree_add_bytes()", to put
	  the context handle raw data into the protocol tree.

2003-11-20 23:34  guy

	* packet-rtp.c, packet-rtp.h, gtk/Makefile.am, gtk/Makefile.nmake,
	  gtk/rtp_stream.c, gtk/rtp_stream.h, gtk/rtp_stream_dlg.c:

	  From Lars Roland:

		  - added a pointer to raw rtp data to _rtp_info that can
	  be used by
		    taps;

		  - RTP packets are passed to the tap queue only if they
	  are not
		    error packets (so that you don't need to filter out
	  ICMP
		    packets)

		  - use that pointer in rtp_stream, so it handles packets
	  with
		    padding, and should handle RTP packets fragmented
	  across
		    lower-level packets

		  - moved rtp_stream from tap sources to normal files
		    (prevents on-start-up registration of the rtp_stream
	  tap
		    listener)

		  - rtp_stream tap gets registered/unregistered with the
	  "RTP
		    Streams" dialog box
		    i.e. the tap is registered as long as the dialog box is
	  open.
		    Alternatively, it is de-/registered on demand if RTP
	  Analysis is
		    called directly on a packet.

		  - rtp_stream tap listener no longer uses a filter in
	  dissection
	  `	    and does not need to have a proto tree being built.
	  (performance increase)

		  - fixed: RTP Streams list will get updated in real time
	  if the
		    dialog box is open while a redissection takes place.

2003-11-20 23:21  guy

	* packet-dcerpc-srvsvc.c:

	  #if 0-out some no-longer-used routines.

	  Use #if 0/#endif rather than comments to remove the code that
	  used to refer to those routines - it's a bit more robust in the
	  presence of comments (there aren't currently any, but, just in
	  case somebody adds them...).

2003-11-20 22:50  guy

	* packet-wbxml.c:

	  From Olivier Biot: add support for media type
	  "application/x-prov.syncset+wbxml".

2003-11-20 22:38  guy

	* packet-sip.c:

	  From Martin Mathieson:

		  - Add some summary info to REGISTER requests and
	  responses
		  - Tidy up whitespace a little

2003-11-20 22:24  guy

	* packet-wbxml.c:

	  From Olivier Biot:

		  * Fix an incorrectly #ifdef'ed return introduced by the
	  previous
		    patch
		  * Remove the parsed_length parameter from the function
	  signature
		    of the tag and attribute dissectors - have it return
	  the
		    parsed length, instead
		  * Throw ReportedBoundsError exceptions if we run past the
	  end of
		    the tvbuff, rather than putting a special entry in
		  * Produce consistent and extensive debug logging (enabled
	  by
		    defining DEBUG_wbxml)
		  * Get rid of the dozens of "#ifdef DEBUG ... #endif"
	  constructs
		    for debug logging

2003-11-20 19:05  guy

	* epan/osi-utils.c:

	  From Hannes Gredler: "print_system_id()" should call
	  "print_system_id_buf()", not "print_nsap_net_buf()".	(What idiot
	  made *that* mistake? :-))

2003-11-20 14:29  nneul

	* AUTHORS:

	  update proto list

2003-11-20 06:43  sharpe

	* packet-dcerpc-srvsvc.c:

	  Clean up some IDL and remove some structures that Windows of all
	  flavors does not understand. SHARE_INFO_1004, 1005, 1006, 1007,
	  and 1501 seem not to be understood by any, and it can screw up
	  dissections.

2003-11-20 05:20  guy

	* epan/proto.c:

	  Use "tvb_get_string()" in "proto_tree_set_string_tvb()" - it
	  won't leak memory if it throws an exception, as it checks whether
	  the entire string is in the tvbuff *before* allocating a buffer
	  for it, and that also means that if the length is absurdly large,
	  an exception will be thrown, rather than the memory allocation
	  failing.

2003-11-20 05:04  guy

	* epan/resolv.c:

	  On Mac OS X, disable the alarm/longjmp stuff for timing out name
	  resolution queries - it runs a significant risk of crashing
	  applications that do that.

2003-11-20 04:28  gerald

	* AUTHORS, doc/ethereal.pod:

	  Update Jakob Schlyter's address.

2003-11-19 22:55  guy

	* packet-wbxml.c:

	  From Olivier Biot: fix  the WBXML dissector in cases where
	  dissection is interrupted because of a short frame or packets not
	  being reassembled, and provide additional debug logging.

2003-11-19 22:13  nneul

	* Makefile.am, Makefile.nmake, packet-sebek.c:

	  Add dissector for the SEBEK kernel read() data capture and/or
	  rootkit tool used as part of the HoneyNet project.

	  Info at: http://project.honeynet.org/tools/sebek/

2003-11-19 21:24  guy

	* packet-wsp.c:

	  From Olivier Biot:

		  correct (and document) the offset computation in the
	  parameter()
		  and parameter_value_q() functions.

	  From Loïc Minier:

		  - a copy-paste with a missing replacement;
		  - content-disposition uses parameters not q-values;
		  - missing "+" for the calculation of parameter-offsets;
		  - white-space cleanup;
		  - comment fixes.

2003-11-19 09:58  guy

	* packet-isis-lsp.c, packet-isis-lsp.h:

	  Fix the ATT bit definitions.

2003-11-19 09:49  guy

	* packet-cpfi.c:

	  Get rid of unused variables.

2003-11-19 09:43  guy

	* packet-wsp.c:

	  From Olivier Biot: get rid of no-longer-used routines.

2003-11-19 09:32  sahlberg

	* packet-tcp.c:

	  Update to TCP,   when we see a SYN|ACK packetm reset base_ack to
	  the current ACK-1 so that it looks right when doing relative
	  sequence numbers.  I.e. SEQ :    seq==0  ack==0      SEQ|ACK
	  seq==0  ack==1      ACK      seq==1  ack==1

	  This looks much more correct.

	  This change also fixes the problem reported to ethereal-dev
	  recently with "Follow TCP Stream" dropping the first character of
	  the stream.

2003-11-19 07:13  sharpe

	* packet-dcerpc-wkssvc.c:

	  Fix some IDL ...

2003-11-19 04:30  guy

	* packet-fcswils.c:

	  From Dave Sclarsky: fix the offset for the Node WWN.

2003-11-19 04:26  guy

	* packet-cpfi.c:

	  Get rid of some unused arguments and variables.

	  Clean up the handling of the footer, so that it works even with
	  short frames.

2003-11-19 04:05  guy

	* packet-cpfi.c:

	  "uint" preferences should be "guint"s, not "int"s.

2003-11-19 04:02  guy

	* packet-cpfi.c:

	  Fix a typo.

2003-11-19 04:00  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-cpfi.c,
	  doc/ethereal.pod:

	  From Dave Sclarsky: CPFI support.

2003-11-19 03:53  guy

	* packet-smb-browse.c, packet-smb-logon.c, packet-smb-mailslot.c:

	  "dissect_mailslot_browse()", "dissect_mailslot_lanman()", and
	  "dissect_smb_logon()" always return TRUE, so just get rid of
	  their return value.

	  "call_dissector()" automatically calls the data dissector if the
	  protocol for the dissector being called is disabled, so we don't
	  have to check its result and call the data dissector if it
	  returns 0.

2003-11-19 02:58  guy

	* packet-mmse.c:

	  Register the MMSE dissector with the "http.content_type"
	  dissector table, rathe than as a heuristic subdissector of HTTP.

2003-11-19 01:50  guy

	* gtk/supported_protos_dlg.c:

	  Use "OK" for the "OK" button, as we do elsewhere.

2003-11-19 01:45  guy

	* packet-wsp.c:

	  From Olivier Biot:

		  Implement quoted-string parsing by appending the closing
	  quote
		  to the string value.	If the quoted-string value does not
	  start
		  with a quote, dissection resumes but a warning is
	  displayed.
		  Textual headers are assumed to be 0x00 terminated
	  (otherwise we
		  have a malformed packet or a short frame).

		  The Trailer header is also dissected now, and the charset
		  parameter dissection has been rewritten.

		  The Content-ID header dissector was registered at the
	  place of
		  the Trailer dissector; this has also been fixed.

2003-11-19 01:39  guy

	* packet-ansi_map.c:

	  From Michael Lum: fix param_digits() subtree for "Nature of
	  Number".

2003-11-19 00:10  ulfl

	* gtk/gui_prefs.c:

	  redraw supported_protos dialog, if GUI prefs changed

2003-11-19 00:04  ulfl

	* gtk/menu.c:

	  added supported_protos menu item

2003-11-19 00:02  ulfl

	* gtk/Makefile.am:

	  added supported_protos_dlg

2003-11-19 00:01  ulfl

	* gtk/Makefile.nmake:

	  added supported_protos_dlg.obj

2003-11-18 23:56  ulfl

	* gtk/: supported_protos_dlg.c, supported_protos_dlg.h:

	  seperated "supported protocols and protocol fields" dialog,
	  coming from help_dlg.c/.h

2003-11-18 23:40  ulfl

	* Makefile.nmake:

	  generate "static" help content

2003-11-18 23:11  ulfl

	* help/: capture_filters.txt, convert-include.sh, Makefile.nmake,
	  display_filters.txt, faq.txt, overview.txt, well_known.txt:

	  "static content" and make environment of redesigned online help

2003-11-18 19:56  guy

	* packet-bootp.c:

	  From Greg Morris:

		  dissect the RFC 2610 DHCP options for SLP;

		  dissect Novell-specific options 85, 86, and 87.

2003-11-18 19:46  guy

	* packet-tcp.c:

	  From Lars Roland: the window size passed to
	  "tcp_analyze_sequence_number()" is a "guint32", as it might be
	  scaled - make the arugment a "guint32" as well.

2003-11-18 19:36  guy

	* plugins/: Xass-list, Xplugin_api.c, Xplugin_api.h,
	  Xplugin_api_decls.h, Xplugin_table.h:

	  Get rid of the second "col_set_fence()" entry.

2003-11-18 19:34  guy

	* plugins/plugin_api_list.c:

	  The second of the "col_set_fence()" entries is the one that
	  should've been removed; that way, the ordinals of existing
	  entries in the function vector is preserved.

2003-11-18 19:31  guy

	* plugins/Makefile.nmake:

	  From Lars Roland: put missing "enttec" into "all" list.

2003-11-18 19:29  ulfl

	* gtk/capture_dlg.c:

	  removed MSVC compiler warnings

2003-11-18 19:28  guy

	* packet-ntp.c:

	  From Matthias Drochner:

		  extensions need only be a multiple of 4 bytes in length,
	  not 8
		  bytes;

		  put in a missing increment of "offset".

2003-11-18 19:27  ulfl

	* gtk/print_dlg.c:

	  removed unused vars

2003-11-18 19:26  ulfl

	* plugins/plugin_api_list.c:

	  col_set_fence occurs twice, removed one appearance

2003-11-18 19:20  guy

	* epan/filesystem.h:

	  From Tomas Kukosa: add "extern"s so that the plugin API stuff
	  works.

2003-11-18 19:20  ulfl

	* packet-sdp.c:

	  includes changed, to be working with MSVC also

2003-11-18 19:18  ulfl

	* plugins/rdm/Makefile.nmake:

	  corrected cut and paste errors, makefile was unchanged copied
	  from rtnet

2003-11-18 08:59  guy

	* plugins/: Xass-list, Xplugin_api.c, Xplugin_api.h,
	  Xplugin_api_decls.h, Xplugin_table.h:

	  Add "col_get_writable()", "col_set_writable()", and
	  "col_set_fence()" to the plugin API list.

2003-11-18 08:58  guy

	* plugins/Xplugin_table.h:

	  Export "protocol_t" as an opaque type.

	  Make "proto_is_protocol_enabled()" and
	  "proto_get_protocol_short_name()" take a "protocol_t *" as an
	  argument, so they don't have to look up the "protocol_t" - this
	  will probably speed them up considerably, and they're called on
	  almost every dissector handoff.

	  Get rid of a number of "proto_is_protocol_enabled()" calls that
	  aren't necessary (dissectors called through handles, including
	  those called through dissector tables, or called as heuristic
	  dissectors, aren't even called if their protocol isn't enabled).

	  Change some direct dissector calls to go through handles.

2003-11-18 08:55  guy

	* plugins/plugin_api_list.c:

	  Add "col_get_writable()", "col_set_writable()", and
	  "col_set_fence()" to the plugin API list.

2003-11-18 08:13  guy

	* configure.in, epan/configure.in, wiretap/configure.in:

	  From Olivier Biot: add a "--enable-profile-build" flag to request
	  that "-pg" binaries be built.

2003-11-18 08:04  guy

	* packet-http.c:

	  Content-Type values are case-insensitive; force them to lower
	  case (subdissectors must register their Content-Type values as
	  all-lower-case).

	  Don't include parameters in the value we look up in the
	  Content-Type subdissector table.

2003-11-18 07:49  guy

	* packet-http.c:

	  Add an "http.content_type" dissector table,

	  Process the Content-Type header, and, if one is found, look up
	  its value in the aforementioned dissector table.

2003-11-18 07:08  guy

	* packet-ses.c:

	  Handle concatenated SPDUs.

	  Handle the Serial Number parameter.

2003-11-18 06:31  guy

	* config.guess, config.sub:

	  Latest config.guess and config.sub from

		  http://savannah.gnu.org/projects/config/

2003-11-18 06:06  ulfl

	* gtk/capture_info_dlg.c:

	  removed MSVC warnings

2003-11-18 04:19  gerald

	* doc/ethereal.pod:

	  Document the capture filter changes that were just checked in.

2003-11-18 04:16  gerald

	* util.c, util.h, gtk/main.c:

	  Check the environment variables SSH_CONNECTION, SSH_CLIENT,
	  REMOTEHOST, DISPLAY, and CLIENTNAME (in that order).	If any of
	  them are set, create a capture filter that excludes their traffic
	  and set it as the default.  The longer filters should be
	  efficient without being overly long; they may need some tweaking.

2003-11-18 00:46  ulfl

	* gtk/toolbar.c:

	  removed some warnings

2003-11-17 22:56  sahlberg

	* epan/to_str.c:

	  updates to ip_to_str[_buf]() to make them faster.

	  This functin was in a recent profiling run the fifth most
	  expensive function.  It consumed ~3.5% of the total cpu in that
	  run.

	  Using a static table this function is now just over twice as fast
	  as previously.

	  My testrun calling it 10.000.000 times in a loop changed the
	  execution time from ~17.3s ro ~8.2s

	  If this test was representative for the speedup and if ~3.5 in
	  the profile run was representative for normal cases this should
	  make ethereal ~1.8% faster.  Woohoo.	(low hanging fruit)

2003-11-17 22:34  guy

	* plugins/: acn/Makefile.am, artnet/Makefile.am, asn1/Makefile.am,
	  gryphon/Makefile.am, mgcp/Makefile.am, pcli/Makefile.am,
	  rtnet/Makefile.am:

	  Fix the copyright notices (Gerald has the copyright on Ethereal).

2003-11-17 22:31  guy

	* plugins/giop/Makefile.am:

	  Tweak the introductory comment.

2003-11-17 22:29  guy

	* plugins/: enttec/.cvsignore, rdm/.cvsignore:

	  Fix the .cvsignore files.

2003-11-17 22:26  guy

	* plugins/rdm/packet-rdm.c:

	  From Erwin Rol: check the checksum in RDM packets.

2003-11-17 22:09  guy

	* configure.in:

	  From Loïc Minier: append $(EXEEXT) to the names of binaries, so
	  that the configure script generates the right executable image
	  file names on Cygwin.

2003-11-17 21:52  guy

	* packet-sdp.c:

	  From Lars Roland: use the c= and m= information to set up
	  conversations to use RTP/RTCP.

2003-11-17 20:57  guy

	* AUTHORS, Makefile.am, configure.in,
	  packaging/nsis/Makefile.nmake, packaging/nsis/ethereal.nsi,
	  plugins/Makefile.am, plugins/Makefile.nmake,
	  plugins/artnet/ChangeLog, plugins/artnet/moduleinfo.h,
	  plugins/artnet/packet-artnet.c, plugins/enttec/.cvsignore,
	  plugins/enttec/AUTHORS, plugins/enttec/COPYING,
	  plugins/enttec/ChangeLog, plugins/enttec/INSTALL,
	  plugins/enttec/Makefile.am, plugins/enttec/Makefile.nmake,
	  plugins/enttec/NEWS, plugins/enttec/moduleinfo.h,
	  plugins/enttec/packet-enttec.c, plugins/rdm/.cvsignore,
	  plugins/rdm/AUTHORS, plugins/rdm/COPYING,
	  plugins/rdm/Makefile.am, plugins/rdm/Makefile.nmake,
	  plugins/rdm/moduleinfo.h, plugins/rdm/packet-rdm.c:

	  From Erwin Rol: initial ENTTEC support and RDM support.

2003-11-17 20:00  guy

	* gtk/capture_info_dlg.c:

	  Not all compilers allow array/structure/union members of
	  automatic variables to be initialized to non-constant values (C89
	  says that "All the expressions in an initializer for an object
	  that has static storage duration or in an initializer list for an
	  object that has aggregate or union type shall be constant
	  expressions"; presumably the intent of the former was to avoid
	  run-time initialization and of the latter was to let the
	  initialization be done by copying from a compile-time-created
	  blob of memory), so we have to initialize "info->counts" by hand.

2003-11-17 19:40  guy

	* capture.c:

	  Fix a typo.

2003-11-17 18:23  ulfl

	* etypes.h, packet-ethertype.c:

	  added ETHERTYPE_PROFINET

2003-11-17 00:27  guy

	* gtk/capture_info_dlg.c:

	  "capture()" takes a "struct pcap_stat *" argument, so you need to
	  include <pcap.h> before including "capture.h".

	  Include "dlg_utils.h" to declare "dlg_set_cancel()".

2003-11-17 00:26  guy

	* capture.c:

	  Get rid of a no-longer-used variable.

2003-11-16 23:17  guy

	* Makefile.am, disabled_protos.c, packet-alcap.c,
	  packet-ansi_637.c, packet-ansi_683.c, packet-ansi_a.c,
	  packet-ansi_map.c, packet-atalk.c, packet-clnp.c,
	  packet-dcerpc.c, packet-dcerpc.h, packet-dvmrp.c, packet-fcip.c,
	  packet-giop.c, packet-giop.h, packet-gsm_a.c, packet-gsm_sms.c,
	  packet-gssapi.c, packet-gssapi.h, packet-iscsi.c,
	  packet-mrdisc.c, packet-msnip.c, packet-pim.c, packet-ppp.c,
	  packet-rpc.c, packet-rpc.h, packet-smb-browse.c,
	  packet-smb-browse.h, packet-smb-logon.c, packet-smb-logon.h,
	  packet-smb-mailslot.c, packet-smb-pipe.c, packet-snmp.c,
	  packet-tpkt.c, prefs.c, epan/packet.c, epan/proto.c,
	  epan/proto.h, gtk/dfilter_expr_dlg.c, gtk/help_dlg.c,
	  gtk/proto_dlg.c, plugins/plugin_api_list.c:

	  Export "protocol_t" as an opaque type.

	  Make "proto_is_protocol_enabled()" and
	  "proto_get_protocol_short_name()" take a "protocol_t *" as an
	  argument, so they don't have to look up the "protocol_t" - this
	  will probably speed them up considerably, and they're called on
	  almost every dissector handoff.

	  Get rid of a number of "proto_is_protocol_enabled()" calls that
	  aren't necessary (dissectors called through handles, including
	  those called through dissector tables, or called as heuristic
	  dissectors, aren't even called if their protocol isn't enabled).

	  Change some direct dissector calls to go through handles.

2003-11-16 23:11  sahlberg

	* AUTHORS, Makefile.am, Makefile.nmake, h225-persistentdata.c,
	  h225-persistentdata.h, packet-h225.c, packet-h225.h,
	  tap-h225rassrt.c, doc/ethereal.pod, doc/tethereal.pod,
	  gtk/Makefile.am, gtk/Makefile.nmake, gtk/h225_ras_srt.c:

	  From Lars Roland   Service Response times for H225 RAS

2003-11-16 22:33  sahlberg

	* packet-h450.c:

	  Bugfix for h450.

	  The hf field we give to dissect_per_object_string is a FT_STRING
	  and not a FT_BYTES.  This caused ethereal to abort with an assert
	  failure.

	  This fixes the issue that Keith French recently brought up in his
	  mailing to ethereal-users

2003-11-15 23:58  guy

	* packet-wsp.c:

	  From Olivier Biot: fix the offset for the Encoding-Version header
	  in the general form.

2003-11-15 23:48  guy

	* gtk/menu.c:

	  From Michael Lum: add <shift><control> hotkeys for Protocols and
	  Preferences.

2003-11-15 11:46  ulfl

	* gtk/menu.c:

	  GTK2 specific: use some Ethereal specific stock icons generated
	  in toolbar.c

2003-11-15 11:44  ulfl

	* gtk/: toolbar.c, toolbar.h:

	  handlebar removed, GTK2 specific: generate some Ethereal specific
	  stock icons and use them in the toolbar

2003-11-15 11:39  ulfl

	* config.nmake:

	  added gdk_pixbuf to GTK2 specific libs to link (needed in
	  toolbar.c)

2003-11-15 10:06  ulfl

	* file.c:

	  removed no longer used gtk includes

2003-11-15 08:53  ulfl

	* gtk/capture_info_dlg.c:

	  seperated capture dialog from capture.c and put into new
	  gtk/capture_info_dlg.c, added some tiny bars, that will indicate
	  the percentage, added ESC key handler and use of GTK_STOCK button

2003-11-15 08:50  ulfl

	* gtk/capture_dlg.c:

	  added "#include <epan/packet.h>" to be able to include
	  "capture.h"

2003-11-15 08:47  ulfl

	* capture.c, capture.h, gtk/Makefile.am, gtk/Makefile.nmake:

	  seperated capture dialog from capture.c and put into new
	  gtk/capture_info_dlg.c

2003-11-14 21:18  guy

	* capture.c:

	  When it comes to whether to use "select()" or not, even if you're
	  building in Cygwin's pretend-it's-UNIX environment, we need to
	  treat the platform as Windows.

	  Get rid of the BSD #define - just check for the platforms on
	  which we mustn't use "select()".

2003-11-14 19:20  guy

	* doc/README.developer:

	  Fix the stuff that talks about adding to DISSECTOR_SOURCES to
	  talk about adding to DISSECTOR_SRC instead, and update it to
	  mention "Makefile.nmake" in the first instance.

2003-11-14 18:59  guy

	* packet-gprs-ns.c:

	  From Josef Korelus: update the offset after decoding an IE.

2003-11-14 10:11  guy

	* packet-null.c:

	  Fix the heuristics so that they recognize Linux DLT_NULL headers.

2003-11-14 02:07  guy

	* packet-sip.c:

	  Add support for the compact form of headers.

2003-11-14 01:35  guy

	* packet-tcap.c:

	  From Michael Lum: fix up handling of ABORT package.

2003-11-14 01:27  guy

	* packet-wap.c:

	  From Olivier Biot: fix the debugging output of
	  "tvb_get_guintvar()".

2003-11-13 23:44  guy

	* packet-wsp.c:

	  From Olivier Biot: use "g_strdup_printf()" to generate
	  dynamically-allocated sprintf output.

2003-11-13 23:38  guy

	* packet-eapol.c, packet-isup.c, packet-ldp.c, packet-m2ua.c,
	  epan/proto.c:

	  Require that field names contain only alphanumerics, "-", "_",
	  and ".".

	  Fix the names that contained other characters.

2003-11-13 23:13  guy

	* packet-dcerpc.c:

	  From Jaime Fournier: get rid of space in field name.

2003-11-13 20:53  sahlberg

	* packet-tcp.c:

	  Change the gboolean controlling whether to use TCP Sequence
	  Number Analysis and TCP Relative Sequence Numbers to default to
	  ENABLED instead of DISABLED.

	  These features do not consume that much memory or CPU but will
	  greatly enhance the feature set of ethereal.	Make it enabled by
	  default so also those that never venture into the preferences
	  dialog will benefit from it.

2003-11-13 08:22  sahlberg

	* file.c, doc/ethereal.pod:

	  For Time Reference frames  reset the counter for
	  CulmulativeBytes.  This makes the CulmulativeBytes field make
	  more sense since if we want something to be a TimeReference frame
	  it is likely that we also want to measure BOTH time and number of
	  bytes (==culmulative bytes) until the event we are looking at.

2003-11-13 08:16  sahlberg

	* packet-ip.c:

	  Change the strings shown for ICMP TTL exceeded to match the
	  wording in the standard

2003-11-13 05:08  gerald

	* packet-wsp.c:

	  We can't pass NULLs to proto_tree_add_text().  Replace a bunch of
	  occurrences of match_strval() with val_to_str() so that we don't
	  throw an assertion.

	  These changes fix a problem with a file from Martin Dubovsky;
	  otherwise they haven't been heavily tested.

2003-11-12 23:17  guy

	* plugins/docsis/packet-docsis.c:

	  From Anand Narwani: fix bitmask for Active Grants field.

2003-11-12 22:44  guy

	* packet-wsp.c:

	  From Olivier Biot:

		  implement the TE header decoding;

		  fix the exported add_content_type function;

		  reimplement the header parameter dissection so the
	  parameters
		  also show up in the related header.

2003-11-12 21:22  guy

	* packet-tzsp.c:

	  From Chris Waters:

		  * Better decoding of TZSP header.
		  * Handle unknown tags in packet.
		  * Removed encapsulation types which are not actually
	  supported.
		  * Added tags for original length and sensor address.
		  * Fix signedness of some fields.

	  Get rid of unused "hf_tzsp_reserved" variable.

	  Use -1 rather than "tvb_length(tvb)" when constructing the
	  top-level protocol tree item, and set the length if we have
	  payload that we dissect separately.

	  Have "add_option_info()" take a starting offset, rather than
	  constructing a subset tvbuff for it.

	  Clean up indentation.

2003-11-12 20:44  guy

	* AUTHORS, packet-ntp.c, doc/ethereal.pod:

	  From Matthias Drochner: support for mode 6 and mode 7 control
	  packets and NTP4 autokey extension data.

2003-11-12 19:04  ulfl

	* gtk/print_dlg.c:

	  completely redesigned print dialog layout, to be more obvious to
	  the user

2003-11-12 18:48  gerald

	* file.c:

	  Remove MAX_DECODE_BUFFER_SIZE; it's no longer used.

2003-11-12 09:00  guy

	* packet-dcerpc.c:

	  Put stub data back where it was in the tree before.

2003-11-12 08:58  guy

	* packet-smb.c:

	  If what remains of the SMB byte count exceeds the data left in
	  the tvbuff, show what's left as extra byte parameters - don't act
	  as if there aren't any extra byte parameters.

2003-11-11 20:49  guy

	* packet-null.c, wiretap/snoop.c:

	  From Brian Ginsbach: fix handling of IRIX and UNICOS/mp snoop
	  captures on loopback interfaces.

2003-11-11 20:33  guy

	* packet-ses.c:

	  Add parameter length checking.

2003-11-11 20:11  guy

	* packet-rsvp.c:

	  From Mohammad Hanif: fix dissection of RSVP DETOUR object code.

2003-11-11 20:08  guy

	* image/toolbar/capture_24.xpm, image/toolbar/cfilter_24.xpm,
	  image/toolbar/dfilter_24.xpm, image/toolbar/stock_close_24.xpm,
	  image/toolbar/stock_colorselector_24.xpm,
	  image/toolbar/stock_help_24.xpm,
	  image/toolbar/stock_jump_to_24.xpm,
	  image/toolbar/stock_open_24.xpm,
	  image/toolbar/stock_preferences_24.xpm,
	  image/toolbar/stock_print_24.xpm,
	  image/toolbar/stock_refresh_24.xpm,
	  image/toolbar/stock_right_arrow_24.xpm,
	  image/toolbar/stock_save_24.xpm,
	  image/toolbar/stock_search_24.xpm,
	  image/toolbar/stock_stop_24.xpm, plugins/asn1/moduleinfo.h:

	  Get rid of carriage returns in source files.

2003-11-11 19:24  guy

	* packet-tcp.c:

	  Make the declaration of "process_tcp_payload()" match the
	  definition.

2003-11-11 19:23  guy

	* packet-tacacs.c:

	  "tacplus_pref_cb()" takes no arguments, not an unspecified list
	  of arguments.

2003-11-11 18:25  guy

	* config.nmake:

	  Get rid of GLib 1.3 support - current versions of GTK+ 1.3
	  require GLib 2.0, and earlier versions are sufficiently buggy
	  that we don't want to support them.

2003-11-11 13:59  ulfl

	* gtk/print_mswin.c:

	  added some print dialog flags, to disable some unsupported print
	  features (e.g. selection of pages from X to Y)

2003-11-11 08:29  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-ses.c, packet-ses.h,
	  doc/ethereal.pod:

	  From Yuriy Sidelnikov: ISO 8327-1 Session Protocol support.

2003-11-11 06:10  guy

	* plugins/: plugin_api_list.c, Xass-list, Xplugin_api.c,
	  Xplugin_api.h, Xplugin_api_decls.h, Xplugin_table.h:

	  Add "asn1_id_decode1()" to the list of exported functions.

2003-11-11 05:54  guy

	* packet-ansi_map.c:

	  From Michael Lum:

		  Minor improvements.

		  Added IEI level decoding of cdma2000 Handoff * IOS data
		  parameters.

2003-11-11 05:51  guy

	* packet-ansi_a.c:

	  From Michael Lum:

		  Change P_xxx to ANSI_A_E_xxx.

		  Fix decoding of some parameters.

		  Fix initialization of ett array.

2003-11-11 05:23  guy

	* gtk/gui_prefs.c:

	  The user interface preference page has only 9 rows in the GTK+
	  2.x version.

2003-11-11 05:09  guy

	* gtk/gui_prefs.c:

	  Create the last two items in the GUI preferences page's first
	  column the same way the other items are created - in order, going
	  down the page, and using "pos++" as the table position.

2003-11-10 22:31  guy

	* packet-ansi_a.c:

	  From Albert Chin: <stdlib.h> on HP-UX 11.00 (and possibly 10.20
	  and perhaps some versions of Digital/Tru64 UNIX) drags in
	  <wait.h>, which drags in <sys/procset.h>, which defines P_SID in
	  ways that cause this not to compile.	Use P_MY_SID instead.

2003-11-10 21:42  guy

	* packet-h225.c:

	  From Martin Regner:

		  "aliasAddress", in an EndPoint sequence, is a sequence of
		  aliasAddresses.

		  Don't update the Info or Protocol columns in a pdu_item.

2003-11-10 20:22  guy

	* packet-dcerpc-epm.c:

	  From Yaniv Kaul:

		  1. Add dissection of inquiry type (rpc_c_ep_all_elts /
		     rpc_c_ep_match_by_if / rpc_c_ep_match_by_obj /
		     rpc_c_ep_match_by_both).

		  2. The version field seems incorrect to me - I believe it
	  is usually
		     should be version 2.0, not 0.2.
		     I suspect that the insertion of version information to
	  the hash
		     table is also wrong, (and the get for the version
	  should have
		     used _letohl() ) - but I did not change it.

		  3. Clean up some white space.

2003-11-10 20:15  guy

	* packet-ansi_a.c:

	  From Albert Chin: dynamically allocate the "ett" array - some
	  compilers (such as at least one older version of the HP C
	  compiler) can't cope with constant expressions that involve the
	  "?" operator, it appears; they think it's not a constant
	  expression.

	  Also, as Albert notes, there's no reason for "ett" to be static
	  here.

2003-11-10 08:14  sahlberg

	* packet-q931.c:

	  The Q.931 dissector never checked whether the codeset variable
	  was set to a reasonable value or not.

	  This was problematic and caused crashes since this variable is
	  used as an index into an array where we grab a pointer (which is
	  later dereferenced).

	  Dereferencing that pointer will have surprising effects. Usually
	  crashes.

	  Update Q.931 to verify sanity of the codeset variable everytime
	  it gets set.

2003-11-10 08:02  sahlberg

	* packet-smb.c:

	  Bugfix for ethereal crashes

	  If the ByteCount field in the SMB PDU spanned beyond the end of
	  the packet because the packet was short or because the BC field
	  was corrupted and contained garbade data  then the tree item for
	  the command (the subtree just after the SMBHeader subtree) would
	  describe data continuing beyond the end of the packet.

	  If we selected one such tree in the dissect pane and used
	  Prepare/Match Selected  this would cause the filter build thing
	  to try to access data beyod the end of the packet and ethereal
	  would dump core.

	  Change the END_OF_SMB macro so that it shrinks bc so that bc
	  never describes data beyond the end of the packet.

2003-11-10 07:44  sahlberg

	* packet-ldap.c, gtk/dcerpc_stat.c:

	  Not all LDAP PDUs are aligned to the start of a TCP segment.

	  If we failed to dissect the GSS-SPNEGO blob it probably means
	  that the segment is somewhere in the middle of an LDAP PDU.

	  Just bail out and stop dissecting the PDU instead of aborting
	  ethereal completely using g_assert() since this is not really a
	  pathological error, its just something that can and will happen
	  normally.

2003-11-09 22:57  guy

	* asn1.c, asn1.h:

	  Fix the type of the "integer" argument to
	  "asn1_uint32_value_decode()", as per a note by Michael Lum.

2003-11-09 22:55  guy

	* AUTHORS, packet-rtcp.c, packet-rtp.c, doc/ethereal.pod:

	  From Martin Mathieson: display the bitfields for

		  - the first 2 bytes of RTP headers
		  - the first byte of RTCP report.

2003-11-09 22:49  guy

	* packet-ansi_map.c:

	  From Michael Lum: add the ability to put parameter data at the
	  end of the parameter name so that the user doesn't have to open
	  the parameter subtree to see the most important data.

	  Use "%u", not "%d", to print unsigned quantities.

	  Get rid of includes of <gmodule.h> (we're not loading any code at
	  run-time in the dissector itself), and <sys/types.h> and
	  <netinet/in.h> (we shouldn't need either of those).

2003-11-09 22:41  guy

	* packet-gsm_a.c:

	  From Michael Lum get rid of non-portable "%N$" constructs in
	  printf formats.

	  Use "%u", not "%d", to print unsigned quantities.

	  Get rid of includes of <gmodule.h> (we're not loading any code at
	  run-time in the dissector itself), and <sys/types.h> and
	  <netinet/in.h> (we shouldn't need either of those).

2003-11-09 22:32  guy

	* packet-ansi_a.c:

	  Remove accidentally-inserted letter.

2003-11-09 22:30  guy

	* packet-ansi_a.c:

	  From Michael Lum:

		  Fix some incorrect bit shifts.

		  Get rid of non-portable "%N$" constructs in printf
	  formats.

	  Use "%u", not "%d", to print unsigned quantities.

2003-11-09 22:15  guy

	* plugins/asn1/packet-asn1.c:

	  From Albert Chin: the HP-UX 10.20 C compiler doesn't allow

		  typedef enum _foo foo;
		  enum _foo {
			  ...
		  };

	  You have to define the enum before using it in a typedef.  (If I
	  had my ANSI C89 standard handy, I could say whether that was
	  legal ANSI C or not.)

2003-11-09 22:13  guy

	* packet-bssgp.c:

	  From Albert Chin: get rid of null statements outside of function
	  bodies (that's what the ";" in

		  int
		  foo(...)
		  {
			  ...
		  };

	  is).

2003-11-09 19:53  guy

	* packet-dcerpc-dcom.h:

	  From Albert Chin: get rid of C++ comments.

2003-11-09 01:36  guy

	* prefs.c:

	  From Gisle Vanem:

		  Copy the "gui_fileopen_*" fields in "copy_prefs()".

		  Fix a typo in "free_prefs()".

2003-11-08 05:47  guy

	* packet-tcp.c, packet-tcp.h:

	  Have "decode_tcp_ports()" handle only the handoff to a
	  subdissector - and have it return TRUE if we succeeded, FALSE
	  otherwise - and have an internal "process_tcp_payload()" routine
	  handle the (TCP-specific) PDU tracking and sequence number
	  analysis, with an argument to indicate whether it should do that
	  or not (i.e., whether it's being handed a TCP segment or
	  reassembled data).

2003-11-08 00:09  guy

	* AUTHORS, packet-rsvp.c, doc/ethereal.pod:

	  From Mohammad Hanif:

		  correct and enhance support for RSVP FAST_REROUTE and
	  DETOUR
		  objects (source:
	  draft-ietf-mpls-rsvp-lsp-fastreroute-03.txt);

		  support an RSVP SESSION_OBJECT object with ctype = 1.
	  This
		  object contains resource affinities (source: RFC 3209).

2003-11-08 00:02  guy

	* packet-msproxy.c, packet-socks.c, packet-tcp.c, packet-tcp.h:

	  "decode_tcp_ports()" is for use by protocols that proxy
	  transport-layer packets/sessions, e.g. MSProxy and SOCKS.  It
	  should not cause any of the TCP-specific stuff such as sequence
	  number analysis or PDU tracking to be done.  (Actually, MSProxy
	  and SOCKS should offer desegmentation services *themselves* and
	  do their *own* PDU tracking, rather than just passing stuff on to
	  "decode_tcp_ports()", but that's another matter.)

	  Make "tcp_tree" once again be a local variable to
	  "dissect_tcp()", and pass it as an argument to those functions
	  that use it.

2003-11-07 23:27  guy

	* Makefile.nmake, config.h.win32, config.nmake,
	  wiretap/Makefile.nmake, wiretap/config.h.win32:

	  Let people configure whether to build with Zlib or not solely by
	  controlling whether ZLIB_DIR is defined or not in config.nmake.

2003-11-07 23:26  guy

	* gtk/Makefile.nmake:

	  Nothing here should require zlib.h, so we shouldn't need to do
	  "/I$(ZLIB_DIR)".

2003-11-07 20:23  guy

	* packet-wsp.c:

	  From Olivier Biot: implement the Range, Content-Range and
	  Content-Disposition headers.

2003-11-07 20:07  guy

	* packet-wsp.c:

	  From Olivier Biot: add dissection for the Content-Base headeer.

2003-11-07 08:50  guy

	* packet-fcels.c, packet-fcels.h:

	  From Dinesh Dutt:

	      - Added support for displaying support for
	  Multicast/Broadcast supported
		bits in *LOGI common service params
	      - Removed restriction for "Random Relative Offset" & its
	  alternate to be in
		PLOGI or PDISC only. Some HBAs set it even in FLOGI.

2003-11-07 08:47  guy

	* packet-fcsp.c:

	  From Dinesh Dutt:

	      - Added support for decoding related to Security in *LOGI
	  service params
	      - Added support for new LS_RJT code for authentication
	  failure
	      - Brought packet-fcsp.c up-to-date with FC-SP rev 1.2

2003-11-07 05:26  sahlberg

	* Makefile.am, Makefile.nmake, packet-kpasswd.c:

	  New protocol:   MS Kpasswd  (RFC3244)

	  KPasswd is partially dissected for UDP.

	  It would be very useful if someone added dissection of the asn.1
	  encoded AP_REQ and the KRB-PRIV blobs. I dont think I will add
	  those.

2003-11-07 04:03  sahlberg

	* packet-ldap.c:

	  In some captures we might have already established and BOUND LDAP
	  session where GSS-SPNEGO is used.  If we havent seen the BIND
	  call ethereal would assume it is vanilla non-GSS-SPNEGO LDAP and
	  would fail to decode the packet.

	  Add heuristics to the LDAP dissector so that IF the first 4 bytes
	  of the LDAP PDU looks like ity could be a length field and IF the
	  fifth byte has the value 0x60 then assume what we have is
	  GSS-SPNEGO and assume this and all further commands on this
	  session is GSS-SPNEGO as well.

2003-11-07 03:47  guy

	* packet-http.c:

	  Make a field for the Content-Type entity header, and give it an
	  EH_ value so it can be handled specially (with a string dissector
	  table so that subdissectors can register for particular content
	  types).

2003-11-07 01:29  guy

	* gtk/: menu.c, toolbar.c, toolbar.h:

	  "File->Open" should be available whether or not we have a captue
	  file open.

	  The toolbar equivalent should *not* be available if we have an
	  "Update list of packets in real time" capture running.

	  The toolbar "Save" button should not be available if we don't
	  have an unsaved capture file.

2003-11-06 23:02  guy

	* gtk/menu.c:

	  Make Shift+Control+S an accelerator for "Save As...", as per the
	  GNOME HIG.

2003-11-06 22:45  guy

	* wiretap/: file_access.c, netmon.c, network_instruments.c,
	  network_instruments.h, wtap-int.h:

	  From Scott Emberley: support for writing Network Instruments
	  Observer files.

2003-11-06 09:52  guy

	* doc/README.plugins:

	  Note that not all OSes on which Ethereal runs can support
	  plugins.

	  Note that you have to modify plugins/Makefile.nmake.

	  Fix "plugin/" to "plugins/".

	  Update the sample Makefile.am and Makefile.nmake to match the
	  current state of affairs.

2003-11-06 09:47  guy

	* doc/README.developer:

	  Warn people not to use the "numbered argument" feature that many
	  UNIX printf's implement.

2003-11-06 09:32  guy

	* plugins/acn/packet-acn.c:

	  From Erwin Rol: fix some switched fields.

2003-11-06 09:28  guy

	* packet-sccp.c:

	  From Michael Lum: have the SCCP dissector register itself by
	  name.

2003-11-06 09:18  sahlberg

	* packet-ldap.c, packet-tcp.c:

	  Update to LDAP and TCP

	  LDAP messages that span multiple segments will throw an exception
	  unless we have reassembly enabled.

	  Update TCP so that IF an exception was thrown that we still pick
	  up any hints provided by the subdissector about where the next
	  PDU starts.

	  Update LDAP so that it will rpovide hints to TCP about where the
	  next LDAP PDU starts in the sequence number space.

	  Thus now ethereal can find and dissect LDAP PDUs that starts
	  somewhere in the middle of a TCP segment.

2003-11-06 09:13  guy

	* packet-dcerpc.c:

	  Update a comment.

	  Catch another case where we need to check for a null
	  decrypted_tvb.

2003-11-06 09:05  guy

	* plugins/: acn/Makefile.nmake, artnet/Makefile.nmake,
	  asn1/Makefile.nmake, docsis/Makefile.nmake,
	  gryphon/Makefile.nmake, lwres/Makefile.nmake,
	  megaco/Makefile.nmake, mgcp/Makefile.nmake, pcli/Makefile.nmake,
	  rtnet/Makefile.nmake:

	  Use "$(OBJECTS)" whenever a complete list of .obj files appears,
	  rather than repeating the list from the setting of OBJECTS.

2003-11-06 08:54  guy

	* packet-http.c:

	  Add a mechanism to handle various entity headers, allowing their
	  (string) values to be put into the protocol tree as fields and
	  allowing some headers to get special treatment, and use it for
	  Authorization, Proxy-Authorization, WWW-Authenticate, and
	  Proxy-Authenticate.

2003-11-06 08:51  sahlberg

	* packet-tcp.c:

	  Fix for TCP.

	  If we have short or malformed PDUs in protocols above TCP this
	  will generate an exception and thus some of the stateful things
	  such as keeping track of and printing the tcp analysis data will
	  be shourcutted and not called.

	  Add a wrapper around the call to the subdissectors above TCP so
	  that if an exception is generated we will still catch it and
	  explicitely call tcp_print_sequence_number_analysis() so that
	  also short packets are handled well.

2003-11-06 07:44  sahlberg

	* packet-dcerpc.c:

	  Bugfix for dcerpc parsing of encrypted short packets.

	  Sometimes if we cant decrypt a DCERPC packet decrypted_tvb is
	  NULL.

	  do not pass a NULL pointer to show_stub_data() since this will
	  dump core.

2003-11-05 20:19  guy

	* packet-ansi_a.c:

	  Get rid of includes of <gmodule.h> (we're not loading any code at
	  run-time in the dissector itself), and <sys/types.h> and
	  <netinet/in.h> (we shouldn't need either of those, and they might
	  be responsible for dragging in <sys/procset.h> on Digital UNIX -
	  that header defines P_SID in a way that conflicts with our
	  definition).

2003-11-05 20:10  guy

	* plugins/acn/packet-acn.c:

	  Update from Erwin Rol.

2003-11-05 20:10  guy

	* packet-ldap.c:

	  A "GHashFunc()" returns a "guint", not a "gint".

2003-11-05 09:04  sahlberg

	* gtk/ldap_stat.c:

	  the LDAP service response time dialog

2003-11-05 09:04  sahlberg

	* packet-ldap.c, packet-ldap.h, doc/ethereal.pod, gtk/Makefile.am,
	  gtk/Makefile.nmake, gtk/service_response_time_table.c:

	  update for LDAP measure the response time for some LDAP commands
	  and add a service response time dialog for it

2003-11-05 04:23  guy

	* packet-wtp.c:

	  From Olivier Biot: have a separate subtree ett_ value for
	  concatenated PDUs.

2003-11-04 22:14  guy

	* wiretap/snoop.c:

	  Sigh.  Some snoop files have 6 bytes of padding; assume the file
	  is a snoop file unless it has enoguh padding to hold a Shomiti
	  trailer record.  (DEAR SUN MICROSYSTEMS: PLEASE DO NOT STUFF 16
	  OR MORE BYTES OF PADDING INTO A SNOOP PACKET.  THANK YOU.  HAVE A
	  NICE DAY.)

	  Add a little paranoia about the record and captured data lengths.

2003-11-04 21:44  guy

	* packet-isakmp.c:

	  Get rid of all the UDP-encapsulated IPSec stuff.

	  draft-ietf-ipsec-udp-encaps-06 says "The UDP port numbers are the
	  same as used by IKE traffic, as defined in [Kiv05]", and
	  "[Kiv05]" is draft-ietf-ipsec-nat-t-ike-05, which has been
	  superseded by draft-ietf-ipsec-nat-t-ike-07; the latter appears
	  to imply that it goes over port 4500, not port 500.

	  We already have a draft-ietf-ipsec-udp-encaps-06 dissector for
	  port 4500 (packet-ipsec-udp.c), and it's not entirely clear to me
	  how, if draft-ietf-ipsec-udp-encaps-06 traffic *did* go over port
	  500, you'd distinguish it from regular ISAKMP traffic.

2003-11-04 20:33  guy

	* gtk/prefs_dlg.c:

	  Skip the check for the module if a page doesn't have a module.

2003-11-04 20:22  guy

	* gtk/prefs_dlg.c:

	  Clean up the way we find the properties page for a given protocol
	  somewhat; this fixes a bug wherein we were assuming all modules
	  necessarily had preference pages (they won't, if the only
	  preferences for the module are obsolete preferences).

2003-11-04 19:47  guy

	* packet-wsp.c:

	  From Olivier Biot:

		  * Extra headers: Encoding-Version, WWW-Authenticate,
		    Proxy-Authenticate

		  * Fix memory allocate/free in header parsing functions &
	  macros

		  * Add missing "ok = TRUE" for some header parsing
	  functions

		  * Header subfields all share the same subtree identifier
	  (more
		    intuitive)

		  * Get rid of unused header fields and subtrees

		  * Some whitespace changes

2003-11-04 18:37  guy

	* plugins/asn1/packet-asn1.c, plugins/gryphon/packet-gryphon.c,
	  AUTHORS, doc/ethereal.pod:

	  From Masaki Chikama: fix static compilation of "generic ASN.1"
	  and Gryphon plugins.

2003-11-04 16:44  gerald

	* plugins/asn1/packet-asn1.c:

	  #ifdef out "#include <gtk/gtk.h>", so that --disable-ethereal
	  works again.

2003-11-04 08:16  guy

	* packet-http.c:

	  If we've already constructed a subset tvbuff, don't construct an
	  identical one and throw away the first one.

