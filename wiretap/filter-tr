# filter-tr
#
# Token-Ring Filter
#

protocol tr "Token-Ring";
#length variable;
parents none;

field	sr		"Source-Routed Flag",
				boolean,
				and_mask(127 @ 8);

field	src		"Source Hardware Address",
				ether,
				byte_offset(8);

field	dst		"Destination Hardware Address",
				ether,
				byte_offset(2);

field	srcvendor	"Vendor of Source Hardware Address",
				byte[3],
				byte_offset(8);

field	dstvendor	"Vendor of Destination Hardware Address",
				byte[3],
				byte_offset(2);

field	_next		"Next protocol layer",
				uint8,
				and_mask(192 @ 1);

alias	src		srcaddr;
alias	dst		dest, dstaddr, destaddr;
alias	dstvendor	destvendor;

field	addr		"Hardware Address",
				ether,
				either_of(src, dst);

alias	addr		hwaddr;

field	vendor		"Hardware Vendor",
				byte[3],
				either_of(srcvendor, dstvendor);


#next_protocol {
#	64  : trmac
#	128 : llc
#}

#next_offset {
#	ldx
#	df
#}
